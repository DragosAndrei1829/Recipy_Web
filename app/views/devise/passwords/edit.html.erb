<% content_for :title, 'Change Password' %>
<% content_for :layout, 'auth' %>

<!-- Modern Auth Layout with Logo -->
<div class="flex h-screen w-full">
  <!-- Left: Logo Section -->
  <div class="hidden lg:flex lg:w-[45%] flex-col items-center justify-center p-12 bg-gradient-to-br from-[#10b981] via-[#059669] to-[#0d9488] relative overflow-hidden">
    <!-- Animated Background Pattern -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-0 left-0 w-full h-full" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 40px 40px;"></div>
    </div>
    
    <!-- Logo & Brand -->
    <div class="relative z-10 flex flex-col items-center gap-8">
      <!-- Chef Hat Icon with Smiley -->
      <div class="relative">
        <svg class="w-32 h-32" viewBox="0 0 120 120" fill="none">
          <path d="M30 40 Q20 35 20 50 L20 75 Q20 80 25 80 L95 80 Q100 80 100 75 L100 50 Q100 35 90 40 Q85 20 60 20 Q35 20 30 40 Z" 
                stroke="white" stroke-width="4" fill="white" opacity="0.95"/>
          <path d="M60 80 L50 95 L70 95 Z" fill="white" opacity="0.95"/>
          <circle cx="45" cy="55" r="3" fill="#10b981"/>
          <circle cx="75" cy="55" r="3" fill="#10b981"/>
          <path d="M45 65 Q60 75 75 65" stroke="#10b981" stroke-width="3" stroke-linecap="round" fill="none"/>
        </svg>
      </div>
      
      <!-- Brand Name -->
      <div class="flex flex-col items-center gap-3">
        <h1 class="text-6xl font-black text-white tracking-tight">Recipy</h1>
        <p class="text-xl text-white/90 text-center max-w-md leading-relaxed">
          Set your new password
        </p>
      </div>
      
      <!-- Security Badge -->
      <div class="mt-8 px-6 py-3 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm font-medium flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
        </svg>
        Protected & Encrypted
      </div>
    </div>
  </div>

  <!-- Right: Form Panel -->
  <div class="flex flex-1 flex-col items-center justify-center gap-8 px-8 py-12 lg:px-16 bg-white dark:bg-[#1f1f1f]">
    <div class="w-full max-w-md">
      <div class="flex w-full flex-col items-center justify-center gap-3 mb-8">
        <!-- Mobile Logo -->
        <div class="lg:hidden mb-4">
          <svg class="w-16 h-16" viewBox="0 0 120 120" fill="none">
            <path d="M30 40 Q20 35 20 50 L20 75 Q20 80 25 80 L95 80 Q100 80 100 75 L100 50 Q100 35 90 40 Q85 20 60 20 Q35 20 30 40 Z" 
                  stroke="#10b981" stroke-width="4" fill="#10b981" opacity="0.95"/>
            <path d="M60 80 L50 95 L70 95 Z" fill="#10b981" opacity="0.95"/>
            <circle cx="45" cy="55" r="3" fill="white"/>
            <circle cx="75" cy="55" r="3" fill="white"/>
            <path d="M45 65 Q60 75 75 65" stroke="white" stroke-width="3" stroke-linecap="round" fill="none"/>
          </svg>
        </div>
        <h2 class="text-3xl font-black text-gray-900 dark:text-gray-100"><%= t('devise.passwords.change_password', default: 'Change Password') %></h2>
        <p class="text-sm text-gray-600 dark:text-gray-400 text-center"><%= t('devise.passwords.enter_new_password', default: 'Enter your new secure password') %></p>
      </div>

      <div class="flex w-full flex-col items-start justify-center gap-6">
      <%= form_for(resource, as: resource_name, url: password_path(resource_name), html: { method: :put, class: "w-full space-y-5", data: { turbo: false } }) do |f| %>
        <%= render "devise/shared/error_messages", resource: resource %>
        <%= f.hidden_field :reset_password_token %>

        <div>
          <label class="block text-sm font-semibold mb-2 text-gray-900 dark:text-gray-100"><%= t('devise.passwords.new_password', default: 'New Password') %></label>
          <%= f.password_field :password, autofocus: true, autocomplete: "new-password", required: true, placeholder: "Enter new password",
                class: "w-full px-4 py-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-sm transition-all placeholder-gray-400 dark:placeholder-gray-500" %>
          <% if @minimum_password_length %>
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center gap-1">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
              </svg>
              <%= t('devise.passwords.minimum_chars', count: @minimum_password_length, default: "Minimum #{@minimum_password_length} characters") %>
            </p>
          <% end %>
        </div>

        <div>
          <label class="block text-sm font-semibold mb-2 text-gray-900 dark:text-gray-100"><%= t('devise.passwords.confirm_password', default: 'Confirm Password') %></label>
          <%= f.password_field :password_confirmation, autocomplete: "new-password", required: true, placeholder: "Re-enter new password",
                class: "w-full px-4 py-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-sm transition-all placeholder-gray-400 dark:placeholder-gray-500" %>
        </div>

        <%= f.submit t('devise.passwords.change_password', default: 'Change Password'), 
            class: "h-12 w-full bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 hover:shadow-xl text-white font-bold rounded-xl transition-all hover:scale-[1.02] active:scale-[0.98] cursor-pointer" %>

        <div class="flex w-full items-center justify-center gap-1.5 pt-2">
          <%= link_to new_user_session_path, class: "text-sm font-bold text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 transition-colors flex items-center gap-1" do %>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            <%= t('devise.passwords.back_to_login', default: 'Back to Sign In') %>
          <% end %>
        </div>
      <% end %>
      </div>
    </div>
  </div>
</div>
