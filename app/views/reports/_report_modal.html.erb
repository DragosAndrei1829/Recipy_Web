<!-- Report Modal - Include this once in application layout -->
<div id="report-modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50 p-4">
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
    <!-- Header -->
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <div class="flex items-center justify-between">
        <h3 class="text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2">
          <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"/>
          </svg>
          Raportează conținut
        </h3>
        <button type="button" onclick="closeReportModal()" class="p-2 text-gray-400 hover:text-gray-600 rounded-lg">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Ajută-ne să menținem comunitatea sigură</p>
    </div>

    <!-- Form -->
    <form id="report-form" method="post" class="p-6">
      <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
      
      <!-- Reason Selection -->
      <div class="mb-4">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">De ce raportezi acest conținut?</label>
        <div class="space-y-2">
          <% Report::REASONS.each do |key, label| %>
            <label class="flex items-center gap-3 p-3 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors">
              <input type="radio" name="report[reason]" value="<%= key %>" class="text-red-600 focus:ring-red-500" required>
              <span class="text-sm text-gray-700 dark:text-gray-300"><%= label %></span>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Description -->
      <div class="mb-6">
        <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Detalii suplimentare (opțional)</label>
        <textarea name="report[description]" rows="3" 
                  class="w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500/20 focus:border-red-500 transition-all resize-none"
                  placeholder="Descrie problema mai în detaliu..."></textarea>
      </div>

      <!-- Actions -->
      <div class="flex gap-3">
        <button type="button" onclick="closeReportModal()" class="flex-1 px-4 py-3 text-sm font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 rounded-xl transition-colors">
          Anulează
        </button>
        <button type="submit" class="flex-1 px-4 py-3 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 rounded-xl transition-colors">
          Trimite raportul
        </button>
      </div>
    </form>
  </div>
</div>

<script>
function openReportModal(type, id) {
  const modal = document.getElementById('report-modal');
  const form = document.getElementById('report-form');
  
  // Set form action based on type
  if (type === 'recipe') {
    form.action = '/<%= I18n.locale %>/recipes/' + id + '/reports';
  } else if (type === 'user') {
    form.action = '/<%= I18n.locale %>/users/' + id + '/reports';
  }
  
  // Reset form
  form.reset();
  
  // Show modal
  modal.classList.remove('hidden');
  modal.classList.add('flex');
}

function closeReportModal() {
  const modal = document.getElementById('report-modal');
  modal.classList.add('hidden');
  modal.classList.remove('flex');
}

// Close on backdrop click
document.getElementById('report-modal')?.addEventListener('click', function(e) {
  if (e.target === this) closeReportModal();
});

// Close on Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') closeReportModal();
});
</script>

