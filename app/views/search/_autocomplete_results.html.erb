<% if users.any? || recipes.any? %>
  <div class="search-autocomplete-dropdown">
    <% if users.any? %>
      <div class="search-autocomplete-section">
        <div class="search-autocomplete-section-header">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <span>Utilizatori</span>
        </div>
        <% users.each do |user| %>
          <%= link_to user_path(user, locale: I18n.locale), class: "search-autocomplete-item" do %>
            <% if user.avatar&.attached? %>
              <%= image_tag url_for(user.avatar), class: "search-autocomplete-avatar" %>
            <% else %>
              <div class="search-autocomplete-avatar search-autocomplete-avatar-fallback">
                <%= user.username&.first&.upcase || 'U' %>
              </div>
            <% end %>
            <div class="search-autocomplete-item-content">
              <div class="search-autocomplete-item-title"><%= user.username %></div>
              <div class="search-autocomplete-item-subtitle"><%= user.email %></div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% end %>

    <% if recipes.any? %>
      <div class="search-autocomplete-section">
        <div class="search-autocomplete-section-header">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/>
          </svg>
          <span>Re»õete</span>
        </div>
        <% recipes.each do |recipe| %>
          <%= link_to recipe_path(recipe, locale: I18n.locale), class: "search-autocomplete-item" do %>
            <% if recipe.photos.attached? %>
              <%= image_tag url_for(recipe.photos.first), class: "search-autocomplete-image" %>
            <% else %>
              <div class="search-autocomplete-image search-autocomplete-image-fallback">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/>
                </svg>
              </div>
            <% end %>
            <div class="search-autocomplete-item-content">
              <div class="search-autocomplete-item-title"><%= recipe.title %></div>
              <div class="search-autocomplete-item-subtitle">de <%= recipe.user.username %></div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% end %>

    <% if query.present? && query.length >= 2 %>
      <div class="search-autocomplete-footer">
        <%= link_to search_path(q: query, locale: I18n.locale), class: "search-autocomplete-view-all" do %>
          Vezi toate rezultatele pentru "<%= query %>"
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>

